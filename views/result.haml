%script{:type=>"text/javascript", :src=>"/experiments/canvas-text/render.js"}
:javascript
  $(document).ready(function() {
    var prevent_xss = #{ @result.to_json };
    render("scratch", JSON.parse(prevent_xss["pixels"]));
    document.getElementById("pixels").innerHTML = JSON.stringify(JSON.parse(prevent_xss["pixels"])).replace(/,"/gi, ', "');
  });

%nav
  %a{:href=>"/", :rel => "up"} Experiments
  &gt;
  %a{:href=>"#{link_to(:exp, @exp)}"} #{@exp.name}
  &gt;
  %a{:href=>"#{link_to(:results, @exp)}"} Results
  &gt;
  %b
    #{@result.id}

#experiment
  %h1
    Experiment
    %a{:href=>"#{link_to(:exp, @exp)}"} #{@exp.name}
  %h2 Result #{@result.id}
  - if not @result.title.nil?
    %h3 Title: #{@result.title}
  %h3 User Agent: #{@result.useragent}

  %p
    %a{:href=>"#{link_to(:diff, @exp, @result)}"} (diff)

  = render :haml, :canvas, :layout => false

  %p Pixels:
  #pixels

